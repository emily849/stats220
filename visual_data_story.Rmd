---
title: Features of Youtube Ads
output: html_document
---

<script src="https://code.jquery.com/jquery-3.7.1.min.js" integrity="sha256-/JqT3SQfawRcv/BIHPThkBvs0OEvtFFmqPF/lYI/Cxo=" crossorigin="anonymous"></script>

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo=FALSE, message=FALSE, warning=FALSE, error=FALSE)
library(tidyverse)
library(lubridate)
```

```{js}
$(function() {
  $(".level2").css('visibility', 'hidden');
  $(".level2").first().css('visibility', 'visible');
  $(".container-fluid").height($(".container-fluid").height() + 300);
  $(window).on('scroll', function() {
    $('h2').each(function() {
      var h2Top = $(this).offset().top - $(window).scrollTop();
      var windowHeight = $(window).height();
      if (h2Top >= 0 && h2Top <= windowHeight / 2) {
        $(this).parent('div').css('visibility', 'visible');
      } else if (h2Top > windowHeight / 2) {
        $(this).parent('div').css('visibility', 'hidden');
      }
    });
  });
})
```

```{css}
.figcaption {display: none}
body {
  font-family: serif;
  background-color: #e0ecf4;
}

h1 {
  color: #57549b;
}

h2 {
 color: #57549b;
}

h3 {
 color: #57549b;
}

h4 {
 color: #57549b;
}

p {
font-size: 20px;
color: #57549b;
}
```


```{r}
logged_data <- read.csv("https://docs.google.com/spreadsheets/d/e/2PACX-1vR_7onUBm866lQhkIdG9BkRjjBqQTftFDPhY5n1vo6ehOAN0Lk5hNoz2AxcNXp9o372pND_GEoDAcAc/pub?gid=269772251&single=true&output=csv")

latest_data <- logged_data %>%
  rename(ad = 2,
         when_ad = 3,
         ad_length = 4,
         skip = 5,
         skip_length = 6, 
         video_length = 7, 
         video_views = 8,
         no._of_ads = 9,
         sponsorship = 10)

max_ad_groups <- latest_data %>% group_by(skip) %>% summarise(max_ad = max(ad_length))
max_noskip <- max_ad_groups$max_ad[1]
max_skip <- max_ad_groups$max_ad[2]

new_data <- latest_data %>%
  mutate(view_count = ifelse(video_views > 500000, "more_views", "less_views"),
         actual_watch_time = ifelse(skip=="Yes", skip_length, ad_length))

views <- new_data %>% 
  group_by(view_count) %>%
  summarise(mean_ad = mean(ad_length))

less_views_mean_ad <- views$mean_ad[1] %>% round()
more_views_mean_ad <- views$mean_ad[2] %>% round()

day_rows <- latest_data %>%
  mutate(datetime = dmy_hms(Timestamp),
         date = floor_date(datetime, unit = "day")) 

num_days <- day_rows$date %>% unique() %>% length() # across 6 unique days 

watch_time <- new_data %>%
  group_by(skip) %>%
  summarise(mean_ad = mean(actual_watch_time))

watch_noskip <- watch_time$mean_ad[1] %>% round()
watch_skip <- watch_time$mean_ad[2] %>% round()

```


## How does being skippable affect the length of the ad? 

![Plot of the top 10 longest ads for skippable and unskippable ads](my_plot1.png)
This plot explores the top 10 ads in length for both skippable and unskippable ads. They have been ordered from longest to shortest within each group, with some ads having multiple observations, which are all included. We can see that the maximum length of an ad in seconds for if it was skippable is `r max_skip`, while the longest unskippable ad is `r max_noskip` seconds. 


## Do videos with more views tend to have longer or shorter ads? 

![Plot of ad length by whether the video has more or less views with an X marking the mean ad length for each group](my_plot2.png)
This plot looks at how the number of views affects the length of the ad in seconds. We have categorised them into more_views (number of views is greater than 500,000) and less views (number of views is less than 500,000). The points are scaled so that the size represent the number of observations with the same ad length. The X symbol indicates the mean ad length for each category. Videos with more views have a mean ad length of 
`r more_views_mean_ad` seconds, and videos with less views have a mean ad length of `r less_views_mean_ad` seconds. These observations have been recorded over a course of `r num_days` non-consecutive days. 

## Distribution of the actual ad watch time

![Density plot with vertical lines representing the mean ad watch time for skippable and unskippable ads](my_plot3.png)
This is a density plot showing the distribution of the actual ad watch times. This is measured as the ad length for unskippable ads and the length of time before a skip button is presented for skippable ads. Thus, this reflects the actual time a viewer would spend watching an ad. We have two vertical lines that represent the mean actual watch times for skippable (blue line) and unskippable (green line) ads. When skippable, the length of time spent watching the ad is `r watch_skip` seconds, while the actual ad watch time when unskippable is `r watch_noskip` seconds. 



